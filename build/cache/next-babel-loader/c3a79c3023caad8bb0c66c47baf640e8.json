{"ast":null,"code":"import _message from \"antd/lib/message\";\nimport _Promise from \"@babel/runtime-corejs2/core-js/promise\";\nimport React from \"react\";\nvar __jsx = React.createElement;\nimport { useState, useEffect, useRef, useContext } from 'react';\nimport Link from 'next/link';\nimport Valid from \"../../../components/Valid\";\nimport { regExp } from \"../../../config\";\nimport axios from \"../../../core/axios\";\nconst {\n  loginNameReg,\n  userPasReg\n} = regExp;\nimport { showLoading, hideLoading } from \"../../../core/loading\";\nimport 'antd/lib/message/style/index.less';\nimport Router from 'next/router';\nimport { DataContext, LOGIN } from \"../../../store/data\";\n\nconst UserBox = props => {\n  const nameRef = useRef();\n  const pasRef = useRef();\n  const {\n    data,\n    dispatch\n  } = useContext(DataContext);\n\n  const userLogin = async () => {\n    let nameBool = nameRef.current.check();\n    let pasBool = pasRef.current.check();\n\n    if (!nameBool || !pasBool) {\n      return;\n    }\n\n    let name = nameRef.current.getVal();\n    let pas = pasRef.current.getVal();\n    console.log(name);\n    console.log(pas);\n    await new _Promise((resolve, reject) => {\n      showLoading();\n      let set = setTimeout(() => {\n        _message.success('登录成功');\n\n        hideLoading();\n        resolve({\n          name\n        });\n        dispatch({\n          type: LOGIN,\n          token: 'asdasdasd',\n          user: {\n            name\n          }\n        });\n        Router.replace('/user');\n      }, 5000);\n    }); // const res = await axios.post('/login', {name, pas});\n    // dispatch({ type: LOGIN, token:'asdasdasd', user: { name }});\n    // Router.replace('/user');\n    // console.log(res);\n  };\n\n  return __jsx(\"div\", {\n    id: \"userBox\"\n  }, __jsx(Valid, {\n    className: 'login-input',\n    spanTitle: '登录名',\n    inputPlaceholder: '请输入手机号/用户名',\n    inputType: 'text',\n    inputMaxLength: \"15\",\n    regExp: loginNameReg,\n    nullMsg: '请输入手机号/用户名',\n    errorMsg: '请正确输入手机号和用户名',\n    ref: nameRef,\n    onEnter: userLogin\n  }), __jsx(Valid, {\n    className: 'login-input mb20',\n    spanTitle: '登录密码',\n    inputPlaceholder: '请输入登录密码',\n    inputType: 'password',\n    inputMaxLength: \"16\",\n    regExp: userPasReg,\n    nullMsg: '请输入登录密码',\n    errorMsg: '请正确输入密码',\n    ref: pasRef,\n    onEnter: userLogin\n  }), __jsx(\"div\", {\n    className: 'login-sign clearfix'\n  }, __jsx(Link, {\n    href: {\n      pathname: '/Security/FindPassword',\n      query: {\n        type: 'user'\n      }\n    }\n  }, __jsx(\"a\", {\n    className: 'fr'\n  }, \"\\u5FD8\\u8BB0\\u5BC6\\u7801\\uFF1F\"))), __jsx(\"div\", {\n    className: 'login-btn'\n  }, __jsx(\"a\", {\n    onClick: userLogin\n  }, \"\\u767B\\u5F55\")), __jsx(\"div\", {\n    className: 'login-sign clearfix'\n  }, __jsx(Link, {\n    href: {\n      pathname: '/regist',\n      query: {\n        type: 'user'\n      }\n    },\n    replace: true\n  }, __jsx(\"a\", {\n    className: 'red fr'\n  }, \"\\u6CE8\\u518C\")), __jsx(\"span\", {\n    className: 'fr mr5'\n  }, \"\\u6CA1\\u6709\\u8D26\\u53F7\\uFF1F\")));\n};\n\nexport default UserBox;","map":null,"metadata":{},"sourceType":"module"}